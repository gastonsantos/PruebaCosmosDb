@model PruebaMongo.Models.Property

@{
    ViewData["Title"] = "Detalle";
}
<style>
    .date-button {
        display: inline-block;
        margin-right: 5px;
    }

    .date-button input[type="radio"] {
        display: none;
    }

    .date-button label {
        display: block;
        padding: 10px 20px;
        background-color: #f0f0f0;
        border: 1px solid #ccc;
        cursor: pointer;
        border-radius: 30px;
    }

    .date-button input[type="radio"]:checked + label {
        background-color: #007bff;
        color: #fff;
     }

    #solicitarVisita{
        display: none;
    }

    .botones{
        margin-left: 25%;
    }
</style>

<h1>Detalle</h1>

<div>
    <h4>@Model.Titulo</h4>
    <hr />
    <div class="row">
        <div class="col-lg-4">
            <img class="w-100" src="@(Model.Imagen != null ? Model.Imagen : "/Assets/default-house-image.jpg")" />
        </div>
        <div class="col-lg-8 mt-4 mt-lg-0">
             <h4>Contacto</h4>
             <p>@Model.Agente.Nombre</p>
             <p>Tel: @Model.Agente.Telefono</p>
             <p>Email: @Model.Agente.Email</p>

            <h4>Dirección</h4>
            <p>@Model.Ubicacion.Provincia, @Model.Ubicacion.Localidad</p>
            <p>@Model.Ubicacion.Calle, @Model.Ubicacion.Numero, CP: @Model.Ubicacion.CodigoPostal</p>
            <p>Piso: @Model.Ubicacion.Piso,Departamento: @Model.Ubicacion.Departamento</p>
            <h5>USD$@Model.Precio</h5>

                <div class="row flex-wrap">
                    <div class="card col-6 col-md">
                        <div class="card-body text-center">
                            <img src="/images/icons/area.png" class="w-50"/>
                                <h5>Superficie</h5>
                                <p>@Model.MetrosCuadrados mts.</p>
                        </div>
                     </div>
                    <div class="card col-6 col-md">
                        <div class="card-body text-center">
                            <img src="/images/icons/ambientes.png" class="w-50" />
                                <h5>Ambientes</h5>
                                <p>@Model.Habitaciones</p>
                        </div>
                    </div>
                    <div class="card col-6 col-md">
                        <div class="card-body text-center">
                            <img src="/images/icons/baños.png" class="w-50" />
                                <h5>Baños</h5>
                                <p>@Model.Banos</p>
                        </div>
                    </div>

                    <div class="card col-6 col-md">
                        <div class="card-body text-center px-2">
                            <img src="/images/icons/cocheras.png" class="w-50" />
                                <h5>Cochera</h5>
                                <p>@(Model.Garaje ? "1" : "0")</p>
                        </div>
                    </div>

                </div>

                    <div class="my-2 float-end">                      
                        <button class="btn btn-primary" id="reservar">RESERVAR VISITA</button>
                    </div>
            </div>
        </div>
    </div>

    <div class="mt-4">
        <h4>Descripción</h4>
        <p>@Model.Descripcion</p>
    </div>

<div>
    <a asp-action="Listar"  asp-controller="Property">Volver a la lista</a>
</div>

<div id="solicitarVisita">
    <div class="container text-center">
        <form>
            <!-- Dias -->
            <div class="container text-center" id="dias">
                <h3 class="py-3">Solicitar visita:</h3>

            </div>

            <!-- Rango Horario -->
            <div class="container text-center py-3">
                <div class="date-button">
                    <input type="radio" id="mañana" name="rangoHorario">
                    <label for="mañana">Por la mañana</label>
                </div>
                <div class="date-button">
                    <input type="radio" id="tarde" name="rangoHorario">
                    <label for="tarde">Por la tarde</label>
                </div>
            </div>
            
            <!-- Datos del usuario -->
            <div class="row g-3 w-50 d-inline-flex">
                <div class="col-12">
                    <input type="email" class="form-control" id="email" placeholder="Email">
                </div>
                <div class="col-md-6">
                    <input type="text" class="form-control" id="nombre" placeholder="Nombre">
                </div>
                <div class="col-md-6">
                    <input type="tel" class="form-control" id="telefono" placeholder="Teléfono">
                </div>

            </div>

            <div class="row g-3 w-50 py-3 botones">
                <div class="col-md-6">
                    <button type="button" class="btn btn-danger w-100" id="cancelar">Cancelar</button>
                </div>
                <div class="col-md-6">
                    <button type="submit" class="btn btn-primary w-100">Solicitar visita</button>
                </div>
            </div>

        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {

        (function () {
            let fecha = (function () {
                let now = new Date();
                return new Date(now.setDate(now.getDate() - now.getDay() - -1));
            })();

            let meses = [
                "Enero",
                "Febrero",
                "Marzo",
                "Abril",
                "Mayo",
                "Junio",
                "Julio",
                "Agosto",
                "Septiembre",
                "Octubre",
                "Noviembre",
                "Diciembre"
            ];

            let semana = Array(5).fill(fecha).map(function (fecha, i) {
                if (i !== 0) {
                    fecha.setDate(fecha.getDate() + 1);
                }
                let name = fecha.toLocaleDateString('es-ES', { weekday: 'long' });
                return {
                    "dia": name.charAt(0).toUpperCase() + name.slice(1),
                    "numero": fecha.getDate(),
                    "mesNumero": fecha.getMonth() + 1, 
                    "mes": meses[fecha.getMonth()]
                };
            });
            
            let contador = 0;
            let seccionDias = document.getElementById("dias");

            semana.forEach(function (dia) {
                contador++;
                let div = document.createElement('div');
                div.className = 'date-button';
                let input = document.createElement('input');
                input.type = 'radio';
                input.id = 'date' + contador;
                input.name = 'date';
                let label = document.createElement('label');
                label.htmlFor = 'date' + contador;
                label.textContent = dia.dia + ' ' + dia.numero;
                div.appendChild(input);
                div.appendChild(label);
                seccionDias.appendChild(div);
            });
            console.log(semana);
        })();

        let dateButtons = document.getElementsByClassName('date-button');
        let fechaSeleccionada;

        for (let i = 0; i < dateButtons.length; i++) {
            dateButtons[i].addEventListener('click', function () {
                let siblings = this.parentNode.children;
                for (let j = 0; j < siblings.length; j++) {
                    siblings[j].classList.remove('active');
                }
                this.classList.toggle('active');

                // Mostrar por consola la fecha seleccionada
                let label = this.querySelector('label');
                fechaSeleccionada = label.textContent;
                console.log("Fecha seleccionada:", fechaSeleccionada);
            });
        }

        document.getElementById("reservar").addEventListener("click", function () {
            let seccionSolicitarVisita = document.getElementById("solicitarVisita");
            seccionSolicitarVisita.style.display = "block";
        });

        document.getElementById("cancelar").addEventListener("click", function () {
            let seccionSolicitarVisita = document.getElementById("solicitarVisita");
            seccionSolicitarVisita.style.display = "none";
        });

    });

</script>